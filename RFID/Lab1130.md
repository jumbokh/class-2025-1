太好了！我把「加入 MySQL」的一整套循序實驗都整理好了，含資料庫結構 SQL、可直接跑的 Python 範例、以及教師版講義（評分規準）。全部打包好了：

* **[下載整包 ZIP](sandbox:/mnt/data/ACR122U_MySQL_Labs_Pack.zip)**
* **[只下載教師版講義 .docx](sandbox:/mnt/data/mysql_labs/ACR122U_MySQL_Teacher_Handout.docx)**
* **[只下載資料庫結構 SQL](sandbox:/mnt/data/mysql_labs/rfid_schema.sql)**

# 實驗階梯（由淺入深）

1. **實驗 0：建庫與連線**

   * 安裝：`pip install pymysql pyscard flask`
   * 複製 `db_config_example.json` → `db_config.json`（填上你的 MySQL 連線）
   * 建庫建表：`python ex1_init_db.py --schema rfid_schema.sql`
   * 產物：資料庫 `rfidlab`、表 `cards / scans / sector_dumps / writes / wallet_txns / mifare_keys`、檢視 `last20_scans / card_summary`

2. **實驗 1：刷卡事件寫入 MySQL（基本日誌）**

   * 執行：`python ex2_log_swipe_mysql.py`
   * 功能：偵測卡片、將 ATR+UID 記錄到 `scans`，並更新 `cards.last_seen / scan_count`
   * 查驗：`SELECT * FROM last20_scans;`、`SELECT * FROM card_summary;`

3. **實驗 2：Flask 顯示最近 20 筆**

   * 執行：`python ex3_flask_last20_mysql.py --host 0.0.0.0 --port 5000`
   * 頁面：`/` 表格顯示最近 20 筆、`/api/scans` 提供 JSON

4. **實驗 3：扇區備份（Sector Dump → DB）**

   * 執行：`python ex4_dump_sector_mysql.py --sector 1 --keya FFFFFFFFFFFF`
   * 功能：讀取該扇區 4 個 block，寫入 `sector_dumps`，並在 `scans` 留下 dump 記錄（OK / AUTH_FAIL / READ_FAIL）

5. **實驗 4：選擇區塊寫入 16B 訊息（含審計）**

   * 執行：`python ex5_write_message_mysql.py --block 4 --message "Hello RFID"`
   * 安全：禁止 `block 0` 與任一 trailer（3,7,...）
   * 審計：前後內容寫入 `writes(before_hex/after_hex)`，並在 `scans` 記錄 `write`

6. **實驗 5：錢包值增減（Value Block）**

   * 執行：`python ex6_wallet_value_mysql.py --block 8 --delta 10`（再做 `--delta -3`）
   * 功能：依 MIFARE Value Block 格式寫入，驗證後記錄到 `wallet_txns` 與 `scans`

# 資料庫結構重點

* `cards`：每張卡的 UID、ATR、首次/最後掃描時間、掃描次數
* `scans`：所有事件記錄（present / read / dump / write / value_write），含 SW1/SW2 與狀態
* `sector_dumps`：指定扇區的 4 個區塊備份（hex + ASCII）
* `writes`：寫入前後 16B 內容紀錄
* `wallet_txns`：錢包交易（delta、value_after）
* `mifare_keys`：扇區金鑰（僅限自有空白卡的學習用途）

# 教師版講義（含評分規準）

講義已內嵌步驟、驗收要點與 100 分配分標準，直接可印製發放。

---

需要我**把這套 MySQL 實驗整合進你之前的 Flask 教案（同一份大講義）**、或是**再加一頁考試題庫（實作＋SQL 查詢題）**嗎？我可以直接在現有檔上追加。
