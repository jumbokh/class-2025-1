# 第 8 週｜創作黑客松（RFID × IoT 應用創作）

> 目標：把第 5–7 週的「門禁／電子錢包／資產出借＋盤點」能力，整合成**一個可演示的最小可行產品（MVP）**。
> 時長：4 小時（單次 4h）

---

## 1) 黑客松議程（4 小時節奏）

* **00:00–00:10**｜說明題目＆評分規準、分組（3–4 人/組）
* **00:10–00:35**｜題目選定與需求切分（定義 MVP、畫流程圖/資料表）
* **00:35–01:15**｜骨架搭建（資料表、API Stub、前端/看板框架）
* **01:15–02:40**｜核心功能衝刺（開發＋單元測試＋整合）
* **02:40–03:10**｜穩定性與邊界測試（去重、離線/上線、錯誤處理）
* **03:10–03:35**｜錄 Demo（60–90 秒）＋補 README／架構圖
* **03:35–04:00**｜現場 Demo（每隊 5 分鐘含 Q&A）

---

## 2) 題目方向（六選一；也可自訂）

1. **多門禁＋訪客管理**：Week5 門禁擴充多讀卡機、多入口；新增訪客申請與臨時卡白名單。
2. **電子錢包 × 小販機 PLUS**：Week6 錢包加入每日限額、單品優惠券、HMAC 簽章防竄改、對帳報表。
3. **資產出借＋盤點 PRO**：Week7 借還＋盤點加入逾期通知（Email/Webhook）、盤點地圖（區域/實驗室）。
4. **校園活動打卡與勳章**：刷卡累積時數與徽章，榜單看板（每日/週），防刷（冷卻時間＋黑名單）。
5. **混合題：課室物資借還＋扣點**：借還與錢包整合，逾期扣點、歸還自動退點，盤點核對缺漏。
6. **離線優先 Kiosk**：可離線刷卡與購買，恢復上線批次對帳（去重＋補帳），異常回滾與告警。

> 要求：至少**整合兩個**既有週次的能力（例如：錢包 × 盤點、門禁 × 訪客）。

---

## 3) 最小可行產品（MVP）清單（必做）

* **功能**：完成 2–3 個核心使用情境的 API/畫面（例如「借出→盤點→歸還」、「支付→對帳→報表」）。
* **可靠性**：去重（如 `(uid, txn_no)` 或 `op_no` 唯一）、**不可透支**、錯誤碼清楚。
* **可觀測性**：至少 1 份「近 24 小時」報表 API 或看板（例如：交易總額/逾期數/在線人數）。
* **文件**：README（架構圖＋啟動步驟＋測試腳本）、.env.sample、資料表 SQL 或遷移腳本。
* **演示**：60–90 秒錄影（流程示範）＋ 3–4 張簡報（痛點/方案/架構/成果）。

---

## 4) 衝刺任務板（學生逐步執行）

1. **定題＋畫圖（25 分鐘）**

   * 角色與流程（泳道圖）：Reader → Server → DB → Dashboard／Kiosk
   * 資料表欄位（主鍵、唯一索引、外鍵／狀態列舉）
2. **骨架落地（40 分鐘）**

   * 建 DB（`schema.sql`）＋ `.env.sample`
   * 建 API stub（Flask 路由）＋前端框架（Streamlit 或最簡 HTML）
3. **核心功能（85 分鐘）**

   * 先打通**快路徑**（Happy Path）→ 再補**邊界條件**
   * **去重**：唯一索引或 `INSERT … ON DUPLICATE KEY`／`UPSERT`
   * **離線**：本地 `journal` → `/reconcile` 批次補登（若選此題）
4. **測試與證據（30 分鐘）**

   * `curl`／Postman 腳本、資料庫截圖、看板截圖
   * “壓力點”：重送相同交易、故意斷線、借出未還、超額支付
5. **收尾（20 分鐘）**

   * README 完整化、錄 60–90 秒 Demo、簡報 3–4 張

---

## 5) 評分規準（100 分）

| 指標        | 權重 | 說明                         |
| --------- | -: | -------------------------- |
| 功能完整度     | 30 | 核心流程能跑通、示例資料可復現            |
| 可靠性與資料一致性 | 20 | 去重、不可透支、事務/鎖、錯誤處理          |
| 觀測與報表     | 15 | 至少 1 份統計或圖表，能反映即時/近 24h    |
| 工程品質      | 15 | 專案結構、.env.sample、啟動腳本、程式風格 |
| 文件與演示     | 10 | README、架構圖、Demo 錄影、簡報清楚    |
| 創意加值      | 10 | 差異化功能（簽章/HMAC、多門禁、優惠券/配額…） |

> **加分**（每項 +2～5 分，上限 +10）：簽章/驗簽安全、Webhooks 通知、快取/併發改善、壓力測試報告、Docker 化。

---

## 6) 參考技術菜單（選用）

* **安全**：HMAC（`hashlib.sha256(secret + payload)`）、時戳＋時窗、Nonce 表
* **一致性**：MySQL 唯一鍵＋事務／`SELECT … FOR UPDATE`、樂觀鎖版本號
* **離線**：本地 JSON `journal`；`/reconcile` 去重補登；對帳報表（applied/skipped）
* **觀測**：Streamlit 折線／長條圖；簡單 `/report/*` API
* **併發**：關鍵路徑短交易＋索引設計（`(uid, txn_no)`、`(session_id, tag_uid)`）

---

## 7) 交付與提交

* **Repo 結構**（建議）

  ```
  week8/<team_name>/
    db/ schema.sql  seed.sql
    server/ app.py  (或拆成多檔)
    client/ kiosk.py  reconcile.py  (如有)
    web/ dashboard.py
    .env.sample  requirements.txt
    README.md  slides.pdf  demo.mp4
    tests/ postman_collection.json
  ```
* **提交物**：壓縮包或 Git 連結、Demo 錄影、簡報、測試腳本

---

## 8) 示範三條「MVP 快路徑」

* **A. 逾期清單 + 通知**：`/loan/checkout`→`/loan/return`→`/report/overdue`→（可選）Webhook/Email
* **B. 錢包限額 + 對帳**：`/wallet/purchase`（每日限額）→ 斷線 `journal` → `/wallet/reconcile` → 對帳報表
* **C. 多門禁 + 訪客**：`/auth/checkCard`（白名單/臨時碼）→ `/report/now_in` → 看板

---

## 9) 教師端快速驗收單（5 分鐘/隊）

1. `pip install -r requirements.txt` 後能啟動服務
2. `schema.sql` 建表成功；唯一索引存在
3. 跑官方測試腳本：

   * **重送交易不重複**
   * **透支被拒** 或 **重複借出被拒**
   * **報表可回資料**
4. Demo 流程順暢、文件齊全

---
